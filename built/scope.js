//     scope
//     (c) simonfan
//     scope is licensed under the MIT terms.

define("__scope/iteration",["require","exports","module","lodash"],function(t,i){function e(t){return function(i,e){return t.test(e)}}var n=t("lodash");i.each=function(t,i){for(var e in this)t.call(i,this[e],e);return this},i.eachOwn=function(t,i){return n.each(this,t,i)},i.eachInherited=function(){return this.parentScope.each.apply(this.parentScope,arguments)},i.pick=function(t,i){i=i||this;var s={};return n.isArray(t)?n.each(t,function(t){s[t]=this[t]},this):(n.isRegExp(t)&&(t=e(t)),this.each(function(e,n){t.apply(i,arguments)&&(s[n]=e)})),s},i.pickOwn=function(t,i){return n.isRegExp(t)&&(t=e(t)),n.pick(this,t,i)},i.pickInherited=function(){return this.parentScope.pick.apply(this.parentScope,arguments)}}),define("__scope/evaluation",["require","exports","module","lodash"],function(t,i){var e=t("lodash");i.evaluate=function(t,i){var n;return e.isArray(t)?n=i&&"object"===i.format?this.pick(t):e.map(t,function(t){return this[t]},this):e.isRegExp(t)?n=this.pick(t):(n=this.pick(e.keys(t)),e.defaults(n,t)),n},i.evaluateOwn=function(t,i){var n;return e.isArray(t)?n=i&&"object"===i.format?this.pickOwn(t):e.map(t,function(t){return this.hasOwnProperty(t)?this[t]:void 0}):e.isRegExp(t)?n=this.pickOwn(t):(n=this.pickOwn(e.keys(t)),e.defaults(n,t)),n}}),define("__scope/invocation",["require","exports","module","lodash"],function(t,i){var e=t("lodash");i.evaluateToArguments=function(t,i){var n=this.evaluate(t);e.isArray(t)&&i&&e.defaults(n,i);var s=e.isArray(n)?n:[n];return s},i.invoke=function(t,i,n,s){t=e.isFunction(t)?t:this[t];var r=this.evaluateToArguments(i,s);return t.apply(n,r)},i.fn=function(t,i,n,s,r){var a=this.evaluateToArguments(n,r);return a.unshift(i),i=e.partial.apply(e,a),this[t]=s?e.bind(i,s):i,this}}),define("scope",["require","exports","module","lodash","subject","./__scope/iteration","./__scope/evaluation","./__scope/invocation"],function(t,i,e){var n=t("lodash"),s=t("subject"),r={enumerable:!1},a=e.exports=s({initialize:function(t,i){s.assign(this,t,i)},create:function(t,i){var e=s.assign(n.create(this),t,i);return s.assign(e,{parentScope:this},r),e},assign:function(t,i){return n.isString(t)?this[t]=i:n.isObject(t)&&n.assign(this,t),this}},r);a.assignProto(t("./__scope/iteration"),r).assignProto(t("./__scope/evaluation"),r).assignProto(t("./__scope/invocation"),r)});