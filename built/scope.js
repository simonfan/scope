//     scope
//     (c) simonfan
//     scope is licensed under the MIT terms.

define("__scope/iteration",["require","exports","module","lodash"],function(t,i){function n(t){return function(i,n){return t.test(n)}}var e=t("lodash");i.each=function(){var t,i,n;if(e.isFunction(arguments[0])){i=arguments[0],n=arguments[1];for(var s in this)i.call(n,this[s],s)}else if(t=arguments[0],i=arguments[1],n=arguments[2],e.isRegExp(t))for(var s in this)t.test(this[s])&&i.call(n,this[s],s);else e.isArray(t)&&e.each(t,function(t){i.call(n,this[t],t)});return this},i.eachOwn=function(){var t,i,n;return e.isFunction(arguments[0])?(i=arguments[0],n=arguments[1],e.each(this,i,n)):(t=arguments[0],i=arguments[1],n=arguments[2],e.isRegExp(t)?e.each(this,function(e,s){t.test(s)&&i.call(n,e,s)}):e.isArray(t)&&e.each(t,function(t){this.hasOwnProperty(t)&&i.call(n,this[t],t)},this)),this},i.pick=function(t,i){i=i||this;var s={};return e.isArray(t)?e.each(t,function(t){s[t]=this[t]},this):(e.isRegExp(t)&&(t=n(t)),this.each(function(n,e){t.apply(i,arguments)&&(s[e]=n)})),s},i.pickOwn=function(t,i){return e.isRegExp(t)&&(t=n(t)),e.pick(this,t,i)}}),define("__scope/evaluation",["require","exports","module","lodash"],function(t,i){var n=t("lodash");i.evaluate=function(t,i){var e;return n.isArray(t)?e=i&&"object"===i.format?this.pick(t):n.map(t,function(t){return this[t]},this):n.isRegExp(t)?e=this.pick(t):(e=this.pick(n.keys(t)),n.defaults(e,t)),e},i.evaluateOwn=function(t,i){var e;return n.isArray(t)?e=i&&"object"===i.format?this.pickOwn(t):n.map(t,function(t){return this.hasOwnProperty(t)?this[t]:void 0}):n.isRegExp(t)?e=this.pickOwn(t):(e=this.pickOwn(n.keys(t)),n.defaults(e,t)),e}}),define("__scope/invocation",["require","exports","module","lodash"],function(t,i){var n=t("lodash");i.evaluateToArguments=function(t){var i=this.evaluate(t),e=n.isArray(i)?i:[i];return e},i.invoke=function(t,i){return t=n.isFunction(t)?t:this[t],i=this.evaluateToArguments(i),t.apply(null,i.concat(Array.prototype.slice.call(arguments,2)))},i.partial=function(t,i){return n.partial(this.invoke,t,i)},i.fn=function(t,i,n){return 1===arguments.length?this[t]:(this[t]=this.partial(i,n),i)}}),define("scope",["require","exports","module","lodash","subject","./__scope/iteration","./__scope/evaluation","./__scope/invocation"],function(t,i,n){var e=t("lodash"),s=t("subject"),r={enumerable:!1},a={enumerable:!1,writable:!1},o=n.exports=s({initialize:function(t,i){s.assign(this,t,i)},create:function(t,i){var n=s.assign(e.create(this),t,i);return s.assign(n,{parentScope:this},r),n},assign:function(t,i){return e.isString(t)?this[t]=i:e.isObject(t)&&e.assign(this,t),this}},r);o.assignProto(t("./__scope/iteration"),a).assignProto(t("./__scope/evaluation"),r).assignProto(t("./__scope/invocation"),r)});