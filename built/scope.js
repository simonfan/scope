//     scope
//     (c) simonfan
//     scope is licensed under the MIT terms.

define("__scope/iteration",["require","exports","module","lodash"],function(t,n){var e=t("lodash");n.each=function(){var t,n,i;if(e.isFunction(arguments[0])){n=arguments[0],i=arguments[1];for(var a in this)n.call(i,this[a],a)}else if(t=arguments[0],n=arguments[1],i=arguments[2],e.isRegExp(t))for(var a in this)t.test(this[a])&&n.call(i,this[a],a);else e.isArray(t)&&e.each(t,function(t){n.call(i,this[t],t)});return this},n.eachOwn=function(){var t,n,i;return e.isFunction(arguments[0])?(n=arguments[0],i=arguments[1],e.each(this,n,i)):(t=arguments[0],n=arguments[1],i=arguments[2],e.isRegExp(t)?e.each(this,function(e,a){t.test(a)&&n.call(i,e,a)}):e.isArray(t)&&e.each(t,function(t){this.hasOwnProperty(t)&&n.call(i,this[t],t)},this)),this}}),define("__scope/evaluation",["require","exports","module","lodash"],function(t,n){function e(t,n,e){var i={};return e.own?r.each(n,function(n){i[n]=r.isString(n)&&t.hasOwnProperty(n)?t[n]:t.evaluateOwn(n,e)}):r.each(n,function(n){i[n]=r.isString(n)?t[n]:t.evaluate(n,e)}),i}function i(t,n,e){return e.own?r.map(n,function(n){return r.isString(n)&&t.hasOwnProperty(n)?t[n]:t.evaluateOwn(n,e)}):r.map(n,function(n){return r.isString(n)?t[n]:t.evaluate(n,e)})}function a(t,n,e){var i={};return e.own?t.eachOwn(function(t,e){n.test(e)&&(i[e]=t)}):t.each(function(t,e){n.test(e)&&(i[e]=t)}),i}function s(t,n,e){var i={};return e.own?r.each(n,function(n,e){t.hasOwnProperty(e)&&(i[e]=t[e])}):r.each(n,function(n,e){i[e]=t[e]}),r.defaults(i,n),i}var r=t("lodash");n.evaluate=function(t,n){return n=n||{},r.isArray(t)?n&&"object"===n.format?e(this,t,n):i(this,t,n):r.isRegExp(t)?a(this,t,n):s(this,t,n)}}),define("__scope/invocation",["require","exports","module","lodash"],function(t,n){var e=t("lodash");n.invoke=function(t,n){t=e.isFunction(t)?t:this[t];var i=this.evaluate(n);return i=e.isArray(i)?i:[i],t.apply(null,i.concat(Array.prototype.slice.call(arguments,2)))},n.partial=function(t,n){return e.partial(this.invoke,t,n)},n.fn=function(t,n,e){return 1===arguments.length?this[t]:(this[t]=this.partial(n,e),n)}}),define("scope",["require","exports","module","lodash","subject","./__scope/iteration","./__scope/evaluation","./__scope/invocation"],function(t,n,e){var i=t("lodash"),a=t("subject"),s={enumerable:!1},r={enumerable:!1,writable:!1},o=e.exports=a({initialize:function(t,n){a.assign(this,t,n)}},s);o.proto({create:function(t,n){var e=a.assign(i.create(this),t,n);return a.assign(e,{parentScope:this},s),e},assign:function(t,n){return i.isString(t)?this[t]=n:i.isObject(t)&&i.assign(this,t),this}},r),o.assignProto(t("./__scope/iteration"),r).assignProto(t("./__scope/evaluation"),r).assignProto(t("./__scope/invocation"),r)});